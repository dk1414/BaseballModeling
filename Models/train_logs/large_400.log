nohup: ignoring input
Device: cuda
Loading Data
Train Shape: (3909900, 93)
Valid Shape: (1491273, 93)
Creating Datasets
Train Label Cols: tensor([ 0,  8,  9, 17]), [tensor([21, 22, 23, 24, 25, 26, 27, 28, 29, 30]), tensor([65, 66, 67, 68, 69, 70, 71, 72, 73, 74])]
Valid Label Cols: tensor([ 0,  8,  9, 17]), [tensor([21, 22, 23, 24, 25, 26, 27, 28, 29, 30]), tensor([65, 66, 67, 68, 69, 70, 71, 72, 73, 74])]
Creating Dataloaders
Starting Experiment: nheads-12, nencoder-12, hdim-96, dropout-0, loss weight-0.3, lr-1e-05, epochs-40
# Params: 712824
Starting epoch: 0
/home/dck5549/miniconda3/envs/BaseballEnv/lib/python3.12/site-packages/torch/nn/parallel/parallel_apply.py:79: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.device(device), torch.cuda.stream(stream), autocast(enabled=autocast_enabled):
/home/dck5549/miniconda3/envs/BaseballEnv/lib/python3.12/site-packages/torch/nn/modules/linear.py:117: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /opt/conda/conda-bld/pytorch_1720538455419/work/aten/src/ATen/cuda/CublasHandlePool.cpp:135.)
  return F.linear(input, self.weight, self.bias)
Epoch 1/40, Train Loss: 1.5208565852664895, Val Loss: 1.4428756576584232
Starting epoch: 1
Epoch 2/40, Train Loss: 1.377763333020758, Val Loss: 1.4139057506925317
Starting epoch: 2
Epoch 3/40, Train Loss: 1.3558850105846634, Val Loss: 1.4003673775862622
Starting epoch: 3
Epoch 4/40, Train Loss: 1.3436069062544018, Val Loss: 1.3899676384977115
Starting epoch: 4
Epoch 5/40, Train Loss: 1.3339952675198223, Val Loss: 1.3800679906593856
Starting epoch: 5
Epoch 6/40, Train Loss: 1.3246631358521086, Val Loss: 1.371259247231227
Starting epoch: 6
Epoch 7/40, Train Loss: 1.3151162861184595, Val Loss: 1.359439462820689
Starting epoch: 7
Epoch 8/40, Train Loss: 1.3061771759681353, Val Loss: 1.3493868013992105
Starting epoch: 8
Epoch 9/40, Train Loss: 1.2983161568623962, Val Loss: 1.3408816952474656
Starting epoch: 9
Epoch 10/40, Train Loss: 1.2914721683454333, Val Loss: 1.3248815596360033
Starting epoch: 10
Epoch 11/40, Train Loss: 1.284957601632172, Val Loss: 1.3164022494387884
Starting epoch: 11
Epoch 12/40, Train Loss: 1.278427521802241, Val Loss: 1.304586047190492
Starting epoch: 12
Epoch 13/40, Train Loss: 1.2720397064659092, Val Loss: 1.288837258110764
Starting epoch: 13
Epoch 14/40, Train Loss: 1.2658360465897494, Val Loss: 1.2830145323789248
Starting epoch: 14
Epoch 15/40, Train Loss: 1.2602708959103304, Val Loss: 1.27128005469999
Starting epoch: 15
Epoch 16/40, Train Loss: 1.2552643781321131, Val Loss: 1.264858197755711
Starting epoch: 16
Epoch 17/40, Train Loss: 1.2508618556822104, Val Loss: 1.2624739598330632
Starting epoch: 17
Epoch 18/40, Train Loss: 1.246752937538904, Val Loss: 1.249442901547237
Starting epoch: 18
Epoch 19/40, Train Loss: 1.2427762782744518, Val Loss: 1.2429906495796736
Starting epoch: 19
Epoch 20/40, Train Loss: 1.2390188084155647, Val Loss: 1.2439151341812584
Starting epoch: 20
Epoch 21/40, Train Loss: 1.2353442486795145, Val Loss: 1.2347023936497268
Starting epoch: 21
Epoch 22/40, Train Loss: 1.2318308059184497, Val Loss: 1.225104063864677
Starting epoch: 22
Epoch 23/40, Train Loss: 1.228544096668275, Val Loss: 1.2238011778682791
Starting epoch: 23
Epoch 24/40, Train Loss: 1.2255249971164186, Val Loss: 1.2226328435764517
Starting epoch: 24
Epoch 25/40, Train Loss: 1.2228439283385133, Val Loss: 1.2172364441938297
Starting epoch: 25
Epoch 26/40, Train Loss: 1.2204394356534798, Val Loss: 1.2145764228733638
Starting epoch: 26
Epoch 27/40, Train Loss: 1.2181754290849596, Val Loss: 1.20926993235465
Starting epoch: 27
Epoch 28/40, Train Loss: 1.2161311031812831, Val Loss: 1.2059448010562568
Starting epoch: 28
Epoch 29/40, Train Loss: 1.2141774759958879, Val Loss: 1.2042449256553445
Starting epoch: 29
Epoch 30/40, Train Loss: 1.2124485173472512, Val Loss: 1.1996010160574349
Starting epoch: 30
Epoch 31/40, Train Loss: 1.2108280829539304, Val Loss: 1.1995343254714883
Starting epoch: 31
Epoch 32/40, Train Loss: 1.209320849083307, Val Loss: 1.1986475479090086
Starting epoch: 32
Epoch 33/40, Train Loss: 1.2078689928619126, Val Loss: 1.1981377914772238
Starting epoch: 33
Epoch 34/40, Train Loss: 1.2064739136912173, Val Loss: 1.196768346601917
Starting epoch: 34
Epoch 35/40, Train Loss: 1.205154880346952, Val Loss: 1.1929590741152405
Starting epoch: 35
Epoch 36/40, Train Loss: 1.2038666040968706, Val Loss: 1.1890753481465002
Starting epoch: 36
Epoch 37/40, Train Loss: 1.2027457356364435, Val Loss: 1.1912254332086092
Starting epoch: 37
Epoch 38/40, Train Loss: 1.201646362454511, Val Loss: 1.1884739179765025
Starting epoch: 38
Epoch 39/40, Train Loss: 1.200517255830308, Val Loss: 1.1879713164734584
Starting epoch: 39
Epoch 40/40, Train Loss: 1.199455281228493, Val Loss: 1.1873040101476895
Model saved to fixed_large_400/h12_e12_h96_d0_lp0.3_lr1e-05_ep40/transformer_model.pth
Loss Plot saved to fixed_large_400/h12_e12_h96_d0_lp0.3_lr1e-05_ep40/loss_plot.png
Config saved to fixed_large_400/h12_e12_h96_d0_lp0.3_lr1e-05_ep40/model_config.json
